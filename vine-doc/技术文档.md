



## 连接断开

1、真实服务与内网代理服务断开

- 删除访问者与真实服务的channel缓存
- 向远程代理服务器发送断开连接的消息通知


2、代理服务器与代理客户端断开
代理服务器和代理客户端会存在两种类型的通道，分别是控制通道，每个客户端只有一条，而数据通道则有很多，一个session一条用于传输实际的数据。
所在在处理断开逻辑的时候需要判断是控制连接的断开还是数据隧道连接的断开。

操作：
- 关闭所有代理客户端与真实服务的连接
- 回收数据连接隧道，删除数据隧道连接池
- 数据隧道连接断开的时候需要关闭真实服务的通道







